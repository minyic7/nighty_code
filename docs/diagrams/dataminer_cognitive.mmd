%%{init: {'theme':'dark', 'themeVariables': { 'primaryColor':'#1f2937', 'primaryTextColor':'#fff', 'primaryBorderColor':'#7C3AED', 'lineColor':'#F59E0B', 'secondaryColor':'#6366F1', 'tertiaryColor':'#10B981'}}}%%

graph TB
    %% DataMiner Module - Cognitive Extraction Process
    
    subgraph InputLayer["üì• Input Layer"]
        RawContent[/"Raw Content<br/>‚Ä¢ Text<br/>‚Ä¢ Documents<br/>‚Ä¢ Code<br/>‚Ä¢ Repository"/]
        Schema[/"Target Schema<br/>Pydantic Model"/]
        Config[/"Configuration<br/>‚Ä¢ Mode<br/>‚Ä¢ Thresholds<br/>‚Ä¢ Settings"/]
    end
    
    subgraph CognitivePipeline["üß† Cognitive Processing Pipeline"]
        
        subgraph Discovery["üîç Discovery Phase<br/>Understanding & Analysis"]
            ContentAnalysis["Content Analysis<br/>‚Ä¢ Type Detection<br/>‚Ä¢ Structure Recognition<br/>‚Ä¢ Pattern Identification"]
            SchemaUnderstanding["Schema Understanding<br/>‚Ä¢ Field Requirements<br/>‚Ä¢ Relationships<br/>‚Ä¢ Constraints"]
            StrategySelection["Strategy Selection<br/>‚Ä¢ Simple ‚ö°<br/>‚Ä¢ Multi-stage üîÑ<br/>‚Ä¢ Cognitive üß†<br/>‚Ä¢ Reflective üîÅ"]
        end
        
        subgraph Extraction["‚õèÔ∏è Extraction Phase<br/>Multi-Strategy Processing"]
            
            subgraph SimpleStrategy["‚ö° Simple Strategy"]
                SinglePass["Single Pass<br/>‚Ä¢ Fast Processing<br/>‚Ä¢ Direct Mapping<br/>‚Ä¢ Basic Validation"]
            end
            
            subgraph MultiStage["üîÑ Multi-Stage Strategy"]
                Stage1["Stage 1: Initial<br/>‚Ä¢ Rough Extraction<br/>‚Ä¢ Identify Sections"]
                Stage2["Stage 2: Refinement<br/>‚Ä¢ Detailed Extraction<br/>‚Ä¢ Fill Gaps"]
                Stage3["Stage 3: Validation<br/>‚Ä¢ Schema Compliance<br/>‚Ä¢ Quality Check"]
                
                Stage1 --> Stage2
                Stage2 --> Stage3
            end
            
            subgraph CognitiveStrategy["üß† Cognitive Strategy"]
                Understanding["Understanding<br/>‚Ä¢ Context Analysis<br/>‚Ä¢ Intent Recognition"]
                Planning["Planning<br/>‚Ä¢ Extraction Strategy<br/>‚Ä¢ Resource Allocation"]
                Execution["Execution<br/>‚Ä¢ Guided Extraction<br/>‚Ä¢ Reasoning"]
                
                Understanding --> Planning
                Planning --> Execution
            end
            
            subgraph ReflectiveStrategy["üîÅ Reflective Strategy"]
                InitialAttempt["Initial Attempt"]
                QualityAssess["Quality Assessment<br/>‚Ä¢ Confidence Score<br/>‚Ä¢ Gap Analysis"]
                Improvement["Improvement<br/>‚Ä¢ Targeted Refinement<br/>‚Ä¢ Iterative Enhancement"]
                
                InitialAttempt --> QualityAssess
                QualityAssess --> Improvement
                Improvement -.->|Iterate| InitialAttempt
            end
        end
        
        subgraph Synthesis["üîÆ Synthesis Phase<br/>Integration & Consolidation"]
            ResultMerger["Result Merger<br/>‚Ä¢ Combine Extractions<br/>‚Ä¢ Resolve Conflicts<br/>‚Ä¢ Optimize Structure"]
            GapFiller["Gap Filler<br/>‚Ä¢ Identify Missing<br/>‚Ä¢ Infer from Context<br/>‚Ä¢ Apply Defaults"]
            Enrichment["Data Enrichment<br/>‚Ä¢ Add Metadata<br/>‚Ä¢ Cross-references<br/>‚Ä¢ Relationships"]
        end
        
        subgraph Validation["‚úÖ Validation Phase"]
            SchemaValidation["Schema Validation<br/>‚Ä¢ Type Checking<br/>‚Ä¢ Constraint Validation<br/>‚Ä¢ Required Fields"]
            QualityControl["Quality Control<br/>‚Ä¢ Completeness Check<br/>‚Ä¢ Consistency Check<br/>‚Ä¢ Accuracy Assessment"]
            ConfidenceScoring["Confidence Scoring<br/>‚Ä¢ Field Confidence<br/>‚Ä¢ Overall Confidence<br/>‚Ä¢ Quality Metrics"]
        end
    end
    
    subgraph Intelligence["üéì Intelligence Layer"]
        
        subgraph LearningSystem["üìö Learning System"]
            PatternMemory["Pattern Memory<br/>‚Ä¢ Successful Patterns<br/>‚Ä¢ Failed Patterns<br/>‚Ä¢ Optimizations"]
            SchemaKnowledge["Schema Knowledge<br/>‚Ä¢ Common Structures<br/>‚Ä¢ Best Practices<br/>‚Ä¢ Domain Specifics"]
        end
        
        subgraph AdaptiveControl["üéõÔ∏è Adaptive Control"]
            StrategyOptimizer["Strategy Optimizer<br/>‚Ä¢ Performance Metrics<br/>‚Ä¢ Success Rates<br/>‚Ä¢ Auto-tuning"]
            ThresholdAdjuster["Threshold Adjuster<br/>‚Ä¢ Confidence Levels<br/>‚Ä¢ Quality Standards<br/>‚Ä¢ Processing Limits"]
        end
    end
    
    subgraph OutputLayer["üì§ Output Layer"]
        ExtractedData["Extracted Data<br/>Type-safe Object"]
        Confidence["Confidence Metrics<br/>‚Ä¢ Overall: 0.95<br/>‚Ä¢ Per Field<br/>‚Ä¢ By Strategy"]
        GapAnalysis["Gap Analysis<br/>‚Ä¢ Missing Fields<br/>‚Ä¢ Low Confidence<br/>‚Ä¢ Recommendations"]
        Metadata["Metadata<br/>‚Ä¢ Sources<br/>‚Ä¢ Strategies Used<br/>‚Ä¢ Processing Time"]
    end
    
    %% Flow Connections
    RawContent --> Discovery
    Schema --> Discovery
    Config --> Discovery
    
    Discovery --> ContentAnalysis
    ContentAnalysis --> SchemaUnderstanding
    SchemaUnderstanding --> StrategySelection
    
    StrategySelection -->|Fast| SimpleStrategy
    StrategySelection -->|Thorough| MultiStage
    StrategySelection -->|Complex| CognitiveStrategy
    StrategySelection -->|Iterative| ReflectiveStrategy
    
    SimpleStrategy --> Synthesis
    MultiStage --> Synthesis
    CognitiveStrategy --> Synthesis
    ReflectiveStrategy --> Synthesis
    
    Synthesis --> ResultMerger
    ResultMerger --> GapFiller
    GapFiller --> Enrichment
    
    Enrichment --> Validation
    Validation --> SchemaValidation
    SchemaValidation --> QualityControl
    QualityControl --> ConfidenceScoring
    
    ConfidenceScoring --> ExtractedData
    ConfidenceScoring --> Confidence
    QualityControl --> GapAnalysis
    Enrichment --> Metadata
    
    %% Learning Feedback
    ConfidenceScoring -.->|Feedback| PatternMemory
    GapAnalysis -.->|Learn| SchemaKnowledge
    
    PatternMemory --> StrategyOptimizer
    SchemaKnowledge --> ThresholdAdjuster
    
    StrategyOptimizer -.->|Optimize| StrategySelection
    ThresholdAdjuster -.->|Adjust| QualityControl
    
    style InputLayer fill:#1e293b,stroke:#3b82f6,stroke-width:2px
    style Discovery fill:#2d1b47,stroke:#8b5cf6,stroke-width:2px
    style Extraction fill:#1e3a5f,stroke:#10b981,stroke-width:2px
    style Synthesis fill:#312e4f,stroke:#f59e0b,stroke-width:2px
    style Validation fill:#1e453f,stroke:#ef4444,stroke-width:2px
    style Intelligence fill:#3f2e1e,stroke:#ec4899,stroke-width:2px
    style OutputLayer fill:#1e293b,stroke:#06b6d4,stroke-width:2px